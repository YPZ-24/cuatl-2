{"ast":null,"code":"import { gql } from '@apollo/client';\n;\nexport const getProductsPage = async (apolloClient, filter) => {\n  const formatFilters = () => {\n    let formattedFilters = '';\n\n    if (filter.query) {\n      if (filter.query.department) {\n        formattedFilters += `\n          departments: { slug: \"${filter.query.department}\" }\n        `;\n      }\n\n      if (filter.query.category) {\n        formattedFilters += `\n          categories: { slug: \"${filter.query.category}\" }\n        `;\n      }\n\n      if (filter.query.subcategory) {\n        formattedFilters += `\n          subcategories: { slug: \"${filter.query.subcategory}\" }\n        `;\n      }\n    }\n\n    return formattedFilters;\n  };\n\n  const {\n    error,\n    data\n  } = await apolloClient.query({\n    query: gql`\n      query getProductsPage(\n        $where: JSON! = {\n          active: true\n          ${formatFilters()}\n        }\n      ) {\n        products(start: ${filter.start}, limit: ${filter.limit}, where: $where) {\n          id\n          slug\n          name\n          price\n          offers(where: { active: true }) {\n            id\n          }\n          cover {\n            alternativeText\n            url\n          }\n        }\n      }\n    `\n  });\n  return error !== null && error !== void 0 ? error : data.products.filter(product => product !== null);\n};\nexport const getProductBySlug = async (apolloClient, slug) => {\n  const {\n    error,\n    data\n  } = await apolloClient.query({\n    query: gql`\n      query getProduct($where: JSON! = { active: true, slug: \"${slug}\" }) {\n        products(where: $where) {\n          id\n          name\n          description\n          media {\n            mime\n            url\n          }\n          meta_description\n          meta_title\n          offers(where: { active: true }) {\n            id\n            name\n            description\n            discount\n          }\n          price\n          variants(where: {active: true}) {\n            id\n            color\n            pattern\n            size\n            stock\n          }\n        }\n      }\n    `\n  });\n  return error !== null && error !== void 0 ? error : data.products[0];\n};","map":{"version":3,"sources":["C:/Users/DELL/Desktop/Coatl/Coatl/front-end/actions/fetch-products.ts"],"names":["gql","getProductsPage","apolloClient","filter","formatFilters","formattedFilters","query","department","category","subcategory","error","data","start","limit","products","product","getProductBySlug","slug"],"mappings":"AAAA,SAAuBA,GAAvB,QAAyD,gBAAzD;AAQC;AAED,OAAO,MAAMC,eAAe,GAAG,OAC7BC,YAD6B,EAE7BC,MAF6B,KAGL;AACxB,QAAMC,aAAa,GAAG,MAAM;AAC1B,QAAIC,gBAAgB,GAAG,EAAvB;;AAEA,QAAIF,MAAM,CAACG,KAAX,EAAkB;AAChB,UAAIH,MAAM,CAACG,KAAP,CAAaC,UAAjB,EAA6B;AAC3BF,QAAAA,gBAAgB,IAAK;AAC7B,kCAAkCF,MAAM,CAACG,KAAP,CAAaC,UAAW;AAC1D,SAFQ;AAGD;;AAED,UAAIJ,MAAM,CAACG,KAAP,CAAaE,QAAjB,EAA2B;AACzBH,QAAAA,gBAAgB,IAAK;AAC7B,iCAAiCF,MAAM,CAACG,KAAP,CAAaE,QAAS;AACvD,SAFQ;AAGD;;AAED,UAAIL,MAAM,CAACG,KAAP,CAAaG,WAAjB,EAA8B;AAC5BJ,QAAAA,gBAAgB,IAAK;AAC7B,oCAAoCF,MAAM,CAACG,KAAP,CAAaG,WAAY;AAC7D,SAFQ;AAGD;AACF;;AAED,WAAOJ,gBAAP;AACD,GAxBD;;AA0BA,QAAM;AAAEK,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAkB,MAAMT,YAAY,CAACI,KAAb,CAAmB;AAC/CA,IAAAA,KAAK,EAAEN,GAAI;AACf;AACA;AACA;AACA,YAAYI,aAAa,EAAG;AAC5B;AACA;AACA,0BAA0BD,MAAM,CAACS,KAAM,YAAWT,MAAM,CAACU,KAAM;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtBmD,GAAnB,CAA9B;AAyBA,SAAOH,KAAP,aAAOA,KAAP,cAAOA,KAAP,GAAgBC,IAAI,CAACG,QAAL,CAAcX,MAAd,CAAsBY,OAAD,IAAuBA,OAAO,KAAK,IAAxD,CAAhB;AACD,CAxDM;AA0DP,OAAO,MAAMC,gBAAgB,GAAG,OAC9Bd,YAD8B,EAE9Be,IAF8B,KAGR;AACtB,QAAM;AAAEP,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAkB,MAAMT,YAAY,CAACI,KAAb,CAAmB;AAC/CA,IAAAA,KAAK,EAAEN,GAAI;AACf,gEAAgEiB,IAAK;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7BmD,GAAnB,CAA9B;AAgCA,SAAOP,KAAP,aAAOA,KAAP,cAAOA,KAAP,GAAgBC,IAAI,CAACG,QAAL,CAAc,CAAd,CAAhB;AACD,CArCM","sourcesContent":["import { ApolloClient, gql, NormalizedCacheObject } from '@apollo/client';\n\nimport IProduct from '@/models/IProduct';\n\ninterface IPageFilter {\n  start: number;\n  limit: number;\n  query?: any\n};\n\nexport const getProductsPage = async (\n  apolloClient: ApolloClient<NormalizedCacheObject>,\n  filter: IPageFilter\n): Promise<IProduct[]> => {\n  const formatFilters = () => {\n    let formattedFilters = '';\n\n    if (filter.query) {\n      if (filter.query.department) {\n        formattedFilters += `\n          departments: { slug: \"${filter.query.department}\" }\n        `;\n      }\n\n      if (filter.query.category) {\n        formattedFilters += `\n          categories: { slug: \"${filter.query.category}\" }\n        `;\n      }\n\n      if (filter.query.subcategory) {\n        formattedFilters += `\n          subcategories: { slug: \"${filter.query.subcategory}\" }\n        `;\n      }\n    }\n\n    return formattedFilters;\n  };\n\n  const { error, data } = await apolloClient.query({\n    query: gql`\n      query getProductsPage(\n        $where: JSON! = {\n          active: true\n          ${formatFilters()}\n        }\n      ) {\n        products(start: ${filter.start}, limit: ${filter.limit}, where: $where) {\n          id\n          slug\n          name\n          price\n          offers(where: { active: true }) {\n            id\n          }\n          cover {\n            alternativeText\n            url\n          }\n        }\n      }\n    `\n  });\n\n  return error ?? data.products.filter((product: IProduct) => product !== null);\n};\n\nexport const getProductBySlug = async (\n  apolloClient: ApolloClient<NormalizedCacheObject>,\n  slug: string\n): Promise<IProduct> => {\n  const { error, data } = await apolloClient.query({\n    query: gql`\n      query getProduct($where: JSON! = { active: true, slug: \"${slug}\" }) {\n        products(where: $where) {\n          id\n          name\n          description\n          media {\n            mime\n            url\n          }\n          meta_description\n          meta_title\n          offers(where: { active: true }) {\n            id\n            name\n            description\n            discount\n          }\n          price\n          variants(where: {active: true}) {\n            id\n            color\n            pattern\n            size\n            stock\n          }\n        }\n      }\n    `\n  });\n\n  return error ?? data.products[0];\n};\n"]},"metadata":{},"sourceType":"module"}
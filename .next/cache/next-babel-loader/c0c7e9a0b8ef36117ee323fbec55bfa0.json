{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Head from 'next/head';\nimport { useContext, useEffect, useState } from 'react';\nimport { getDepartments } from '@/actions/fetch-departments';\nimport { getProductBySlug } from \"@/actions/fetch-products\";\nimport AddToBagButton from '@/components/buttons/AddToBagButton';\nimport Carousel from '@/components/carousels/Carousel';\nimport QuantitySelector from '@/components/controls/QuantitySelector';\nimport VariantSelector from '@/components/controls/VariantSelector';\nimport OffersSelector from '@/components/controls/OffersSelector';\nimport Navigationbar from '@/components/navbars/Navigationbar';\nimport AuthContext from '@/context/AuthContext';\nimport { initializeApolloClient } from \"@/lib/apollo-client\";\nimport formatPrice from '@/utils/format-price';\nimport Omnibar from '@/components/navbars/Omnibar';\nconst classes = {\n  container: `\n    h-screen\n    max-w-screen\n    relative\n  `,\n  carousel: `\n    bg-base\n    h-4/6\n    md:absolute\n    md:h-full\n    md:right-12\n    md:rounded-lg\n    md:w-1/2\n    overflow-hidden\n  `,\n  details: `\n    h-11/12\n    overflow-y-scroll\n    pb-20\n    w-full\n  `,\n  information: {\n    container: `\n      bg-bse\n      mt-6\n      md:w-2/5\n      md:absolute\n      md:m-12\n      md:p-12\n      md:bg-base\n      md:shadow\n      md:rounded-2xl\n      md:z-10\n      md:overflow-y-scroll\n      p-7\n      rounded-t-3xl\n      max-w-full\n    `,\n    section: `\n      mb-7\n      w-full\n    `,\n    header: {\n      title: `\n        font-bold\n        font-display\n        mb-2\n        text-2xl\n      `\n    },\n    title: `\n      font-bold\n      mb-2\n    `\n  },\n  addButton: `\n    flex\n    flex-row\n    justify-end\n    mt-12\n  `\n};\nexport default function ProductDetailsPage({\n  departments,\n  product,\n  referer\n}) {\n  const {\n    useSession\n  } = useContext(AuthContext);\n  const {\n    0: selectedVariant,\n    1: setSelectedVariant\n  } = useState(null);\n  const {\n    0: selectedOffers,\n    1: setSelectedOffers\n  } = useState([]);\n  const {\n    0: viewportWidth,\n    1: setViewportWidth\n  } = useState(0);\n  useSession();\n  useEffect(() => {\n    setViewportWidth(window.innerWidth);\n  }, []);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [product.meta_title && /*#__PURE__*/_jsxs(\"title\", {\n        children: [\"Cuatl - \", product.meta_title]\n      }), product.meta_description && /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: product.meta_description\n      })]\n    }), viewportWidth < 768 && /*#__PURE__*/_jsx(Navigationbar, {\n      referer: referer\n    }), viewportWidth >= 768 && /*#__PURE__*/_jsx(Omnibar, {\n      menuEntries: departments\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: classes.details,\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: classes.carousel,\n        children: /*#__PURE__*/_jsx(Carousel, {\n          media: product.media\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: classes.information.container,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: classes.information.section,\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: classes.information.header.title,\n            children: product.name\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"mb-6\",\n            children: formatPrice('MXN', product.price)\n          }), /*#__PURE__*/_jsx(\"p\", {\n            children: product.description\n          })]\n        }), product.variants.length !== 0 && /*#__PURE__*/_jsxs(\"div\", {\n          className: classes.information.section,\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: classes.information.title,\n            children: \"Variante\"\n          }), /*#__PURE__*/_jsx(VariantSelector, {\n            state: [selectedVariant, setSelectedVariant],\n            variants: product.variants\n          })]\n        }), product.offers.length !== 0 && /*#__PURE__*/_jsxs(\"div\", {\n          className: classes.information.section,\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: classes.information.title,\n            children: \"Ofertas\"\n          }), /*#__PURE__*/_jsx(OffersSelector, {\n            offers: product.offers,\n            state: [selectedOffers, setSelectedOffers]\n          })]\n        }), selectedVariant && /*#__PURE__*/_jsxs(\"div\", {\n          className: classes.information.section,\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: classes.information.title,\n            children: \"Cantidad\"\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex flex-row items-center\",\n            children: [/*#__PURE__*/_jsx(QuantitySelector, {\n              stock: selectedVariant.stock\n            }), /*#__PURE__*/_jsxs(\"small\", {\n              className: \"ml-4 text-sm text-neutral\",\n              children: [\"\\xA1\", selectedVariant.stock, \" disponibles!\"]\n            })]\n          })]\n        }), product && selectedVariant && /*#__PURE__*/_jsx(\"div\", {\n          className: classes.addButton,\n          children: /*#__PURE__*/_jsx(AddToBagButton, {\n            order: {\n              offers: selectedOffers,\n              product,\n              variant: selectedVariant\n            }\n          })\n        })]\n      })]\n    })]\n  });\n}\n;\nexport const getServerSideProps = async ({\n  params,\n  req\n}) => {\n  const apolloClient = initializeApolloClient();\n  const departments = await getDepartments(apolloClient);\n  const product = await getProductBySlug(apolloClient, params.slug);\n  return {\n    props: {\n      departments,\n      product,\n      referer: req.headers.referer || '/'\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Head from 'next/head.js';\nimport { useContext, useState } from 'react/index';\nimport { getDepartments } from '@/actions/fetch-departments';\nimport { getProductsPage } from '@/actions/fetch-products';\nimport LoadMoreButton from '@/components/buttons/LoadMoreButton';\nimport ProductsGallery from '@/components/galleries/ProductsGallery';\nimport Footer from '@/components/footers/Footer';\nimport Omnibar from '@/components/navbars/Omnibar';\nimport Tabbar, { TAB_PAGES } from '@/components/navbars/Tabbar';\nimport { PAGE_LIMIT } from '@/config/globals';\nimport AuthContext from '@/context/AuthContext';\nimport { initializeApolloClient, useApolloClient } from '@/lib/apollo-client';\nconst classes = {\n  container: `\n    h-screen\n    max-w-screen\n  `,\n  gallery: {\n    container: `\n      h-3/4\n      md:h-auto\n      md:overflow-visible\n      overflow-y-auto\n      px-7\n      py-12\n      top-0\n      w-full\n    `,\n    loadButton: `\n      flex\n      flex-nowrap\n      flex-row\n      justify-center\n      my-12\n    `\n  }\n};\nexport default function FilteredProductsPage({\n  initialProducts,\n  departments,\n  query\n}) {\n  const {\n    useSession\n  } = useContext(AuthContext);\n  const apolloClient = useApolloClient(initialProducts);\n  const [page, setPage] = useState({\n    index: 0,\n    data: initialProducts,\n    previousData: initialProducts\n  });\n\n  const getNewPage = async () => {\n    const newPage = await getProductsPage(apolloClient, {\n      start: page.data.length,\n      limit: PAGE_LIMIT,\n      query\n    });\n    setPage({\n      index: page.index + 1,\n      data: page.data.concat(newPage),\n      previousData: newPage\n    });\n  };\n\n  useSession();\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Cuatl - La mejor moda artesanal de M\\xE9xico\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Encuentra los mejores productos artesanales de M\\xE9xico\"\n      })]\n    }), /*#__PURE__*/_jsx(Omnibar, {\n      menuEntries: departments\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: classes.gallery.container,\n      children: [/*#__PURE__*/_jsx(ProductsGallery, {\n        products: page.data\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: classes.gallery.loadButton,\n        children: /*#__PURE__*/_jsx(LoadMoreButton, {\n          disabled: !page.previousData.length,\n          fetcher: getNewPage\n        })\n      })]\n    }), /*#__PURE__*/_jsx(Tabbar, {\n      page: TAB_PAGES.HOME\n    }), /*#__PURE__*/_jsx(Footer, {})]\n  });\n}\n;\nexport async function getServerSideProps({\n  query\n}) {\n  const apolloClient = initializeApolloClient();\n  const initialProducts = await getProductsPage(apolloClient, {\n    start: 0,\n    limit: PAGE_LIMIT,\n    query\n  });\n  const departments = await getDepartments(apolloClient);\n  return {\n    props: {\n      initialProducts,\n      departments,\n      query\n    }\n  };\n}\n;","map":null,"metadata":{},"sourceType":"module"}
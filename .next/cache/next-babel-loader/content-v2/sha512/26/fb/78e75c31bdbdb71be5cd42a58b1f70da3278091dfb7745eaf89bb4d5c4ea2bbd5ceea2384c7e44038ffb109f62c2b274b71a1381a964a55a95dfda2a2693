{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState } from 'react/index';\nimport { getDepartments } from '@/actions/fetch-departments';\nimport { getProductsPage } from '@/actions/fetch-products';\nimport LoadMoreButton from '@/components/buttons/LoadMoreButton';\nimport ProductsGallery from '@/components/galleries/ProductsGallery';\nimport { PAGE_LIMIT } from '@/config/globals';\nimport { initializeApolloClient, useApolloClient } from '@/lib/apollo-client';\nexport default function FilteredProductsPage({\n  initialProducts,\n  departments,\n  query\n}) {\n  const apolloClient = useApolloClient(initialProducts);\n  const [page, setPage] = useState({\n    index: 0,\n    data: initialProducts,\n    previousData: initialProducts\n  });\n\n  const getNewPage = async () => {\n    const newPage = await getProductsPage(apolloClient, {\n      start: page.data.length,\n      limit: PAGE_LIMIT,\n      query\n    });\n    setPage({\n      index: page.index + 1,\n      data: page.data.concat(newPage),\n      previousData: newPage\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(ProductsGallery, {\n      products: page.data\n    }), page.previousData.length === PAGE_LIMIT ? /*#__PURE__*/_jsx(LoadMoreButton, {\n      fetcher: getNewPage\n    }) : null]\n  });\n}\n;\nexport async function getServerSideProps({\n  query\n}) {\n  const apolloClient = initializeApolloClient();\n  const initialProducts = await getProductsPage(apolloClient, {\n    start: 0,\n    limit: PAGE_LIMIT,\n    query\n  });\n  const departments = await getDepartments(apolloClient);\n  return {\n    props: {\n      initialProducts,\n      departments,\n      query\n    }\n  };\n}\n;","map":null,"metadata":{},"sourceType":"module"}
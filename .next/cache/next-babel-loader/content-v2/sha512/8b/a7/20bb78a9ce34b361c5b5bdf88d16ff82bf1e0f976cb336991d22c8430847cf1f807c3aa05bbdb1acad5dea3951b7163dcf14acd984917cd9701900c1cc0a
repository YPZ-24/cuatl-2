{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\cuatl-2\\\\context\\\\OrderContext.tsx\";\nimport { createContext, useState, useEffect } from \"react\";\n//: use this context whenever you want to access the OrderProvider\nconst OrderContext = /*#__PURE__*/createContext(null);\nexport default OrderContext;\nexport { OrderProvider }; //: use this component in all the other components where you want to access\n//: the global state of a user order\n\nfunction OrderProvider({\n  children\n}) {\n  const {\n    0: order,\n    1: setOrder\n  } = useState();\n\n  const getOrder = () => {\n    try {\n      return JSON.parse(localStorage.getItem('order')) || [];\n    } catch (error) {}\n\n    return [];\n  };\n\n  useEffect(() => {\n    const o = getOrder();\n    setOrder(o);\n  }, []);\n\n  const countProducts = () => {\n    //return order ? order.variants.length : 0;\n    return 0;\n  };\n\n  const saveOrder = order => {\n    localStorage.setItem('order', JSON.stringify(order));\n  };\n\n  const addProductToBag = (variantQuantity, product) => {\n    console.log(order);\n    const activeOrder = order;\n    debugger; //: if the product and variant is already there\n\n    const indexOfOrderItem = activeOrder.findIndex(orderItem => orderItem.variant.id === product.variant.id);\n    debugger;\n\n    if (indexOfOrderItem !== -1) {\n      //: update quantity\n      const currentQuantity = activeOrder[indexOfOrderItem].quantity;\n\n      if (currentQuantity + variantQuantity <= product.variant.stock) {\n        activeOrder[indexOfOrderItem].quantity = currentQuantity + variantQuantity;\n      }\n\n      debugger;\n    } else {\n      activeOrder.push({\n        product: product.product,\n        variant: product.variant,\n        quantity: variantQuantity,\n        offers: product.offers\n      });\n      debugger;\n    }\n\n    console.log(\"order\");\n    console.log(order);\n    console.log(\"activeOrder\");\n    console.log(activeOrder); //setOrder(activeOrder);\n    //saveOrder(activeOrder)\n  };\n\n  const removeProduct = itemNumber => {\n    alert(\"BORRAR\");\n    order.splice(itemNumber, 1);\n    setOrder(order);\n    saveOrder(order);\n  };\n  /*\r\n    \r\n    const addOrderItem = (item: IPaymentOrder) => {\r\n  };\r\n    //: use this function to add a new item to the order in local storage\r\n  const setOrderItemInLS = (activeOrder: Array<IPaymentOrder>) => {\r\n    localStorage.setItem('orderItems', JSON.stringify(activeOrder));\r\n  };\r\n    //: use this function to get the current order object from local storage\r\n  const getOrderItemFromLS = (): Array<IPaymentOrder> => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('orderItems')) || [];\r\n    } catch (_error) {\r\n      console.error((_error as SyntaxError).message);\r\n      return null;\r\n    }\r\n  };*/\n\n\n  return /*#__PURE__*/_jsxDEV(OrderContext.Provider, {\n    value: {\n      order,\n      countProducts,\n      addProductToBag,\n      removeProduct\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n}\n\n;","map":{"version":3,"sources":["C:/Users/DELL/Desktop/cuatl-2/context/OrderContext.tsx"],"names":["createContext","useState","useEffect","OrderContext","OrderProvider","children","order","setOrder","getOrder","JSON","parse","localStorage","getItem","error","o","countProducts","saveOrder","setItem","stringify","addProductToBag","variantQuantity","product","console","log","activeOrder","indexOfOrderItem","findIndex","orderItem","variant","id","currentQuantity","quantity","stock","push","offers","removeProduct","itemNumber","alert","splice"],"mappings":"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","sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport IPaymentOrder from \"@/models/IPaymentOrder\";\r\n\r\n//: use this context whenever you want to access the OrderProvider\r\nconst OrderContext = createContext(null);\r\n\r\nexport default OrderContext;\r\n\r\nexport { OrderProvider };\r\n\r\n//: use this component in all the other components where you want to access\r\n//: the global state of a user order\r\nfunction OrderProvider({ children }) {\r\n\r\n  const [order, setOrder] = useState<Array<IPaymentOrder>>();\r\n\r\n  const getOrder = (): Array<IPaymentOrder> => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('order')) || [];\r\n    } catch (error) { }\r\n    return [];\r\n  };\r\n\r\n  \r\n  useEffect(()=>{\r\n    const o = getOrder()\r\n    setOrder(o)\r\n  },[])\r\n\r\n  const countProducts = (): number => {\r\n    //return order ? order.variants.length : 0;\r\n    return 0\r\n  };\r\n\r\n  const saveOrder = (order: Array<IPaymentOrder>) => {\r\n    localStorage.setItem('order', JSON.stringify(order));\r\n  };\r\n\r\n  const addProductToBag = (variantQuantity:number, product:IPaymentOrder) => {\r\n    console.log(order)\r\n    const activeOrder = order\r\n    debugger\r\n   //: if the product and variant is already there\r\n   const indexOfOrderItem = activeOrder.findIndex((orderItem: IPaymentOrder) => orderItem.variant.id === product.variant.id);\r\n   debugger\r\n   if (indexOfOrderItem !== -1) {\r\n     //: update quantity\r\n     const currentQuantity = activeOrder[indexOfOrderItem].quantity;\r\n     if (currentQuantity + variantQuantity <= product.variant.stock) {\r\n       activeOrder[indexOfOrderItem].quantity = currentQuantity + variantQuantity;\r\n     }\r\n     debugger\r\n   } else {\r\n     activeOrder.push({\r\n       product: product.product,\r\n       variant: product.variant,\r\n       quantity: variantQuantity,\r\n       offers: product.offers\r\n     });\r\n     debugger\r\n   }\r\n   console.log(\"order\")\r\n   console.log(order)\r\n   console.log(\"activeOrder\")\r\n   console.log(activeOrder)\r\n\r\n    //setOrder(activeOrder);\r\n    //saveOrder(activeOrder)\r\n  };\r\n\r\n  const removeProduct = (itemNumber) => {\r\n      alert(\"BORRAR\")\r\n      order.splice(itemNumber, 1)\r\n      setOrder(order)\r\n      saveOrder(order)\r\n  };\r\n\r\n\r\n  /*\r\n\r\n  \r\n\r\n  const addOrderItem = (item: IPaymentOrder) => {\r\n  };\r\n\r\n  //: use this function to add a new item to the order in local storage\r\n  const setOrderItemInLS = (activeOrder: Array<IPaymentOrder>) => {\r\n    localStorage.setItem('orderItems', JSON.stringify(activeOrder));\r\n  };\r\n\r\n  //: use this function to get the current order object from local storage\r\n  const getOrderItemFromLS = (): Array<IPaymentOrder> => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('orderItems')) || [];\r\n    } catch (_error) {\r\n      console.error((_error as SyntaxError).message);\r\n      return null;\r\n    }\r\n  };*/\r\n\r\n  return (\r\n    <OrderContext.Provider value={{ order, countProducts, addProductToBag, removeProduct }}>\r\n      {children}\r\n    </OrderContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}
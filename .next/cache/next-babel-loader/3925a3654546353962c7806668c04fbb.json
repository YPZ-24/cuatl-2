{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\cuatl\\\\cuatl\\\\front-end\\\\components\\\\buttons\\\\PaymentButton.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport PropTypes from 'prop-types';\nimport { useContext } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { STRIPE_PUBLISHED_KEY, API_DOMAIN } from '@/config/globals';\nimport AuthContext from '@/context/AuthContext';\nvar stripePromise = loadStripe(STRIPE_PUBLISHED_KEY);\n\nvar PaymentButton = function PaymentButton(_ref) {\n  _s();\n\n  var order = _ref.order;\n\n  var _useContext = useContext(AuthContext),\n      getToken = _useContext.getToken;\n\n  var handlePayment = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var stripe, token, response, session, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return stripePromise;\n\n            case 2:\n              stripe = _context.sent;\n              _context.next = 5;\n              return getToken();\n\n            case 5:\n              token = _context.sent;\n              _context.next = 8;\n              return fetch(\"\".concat(API_DOMAIN, \"/orders\"), {\n                method: 'POST',\n                body: JSON.stringify({\n                  order: order\n                }),\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(token)\n                }\n              });\n\n            case 8:\n              response = _context.sent;\n              _context.next = 11;\n              return response.json();\n\n            case 11:\n              session = _context.sent;\n              _context.next = 14;\n              return stripe.redirectToCheckout({\n                sessionId: session.id\n              });\n\n            case 14:\n              result = _context.sent;\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handlePayment() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: handlePayment,\n    className: \"flex flex-row flex-nowrap items-center justify-center font-bold px-4 py-3 rounded-lg bg-accent text-base shadow hover:bg-inactive hover:text-primary\",\n    children: \"Continuar al pago\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(PaymentButton, \"dcdgv0n7fjrvMCwtneAnMNTWaHQ=\");\n\n_c = PaymentButton;\nPaymentButton.propTypes = {\n  order: PropTypes.array\n};\nPaymentButton[\"default\"] = {\n  order: []\n};\nexport default PaymentButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentButton\");","map":{"version":3,"sources":["C:/Users/DELL/Desktop/cuatl/cuatl/front-end/components/buttons/PaymentButton.js"],"names":["PropTypes","useContext","loadStripe","STRIPE_PUBLISHED_KEY","API_DOMAIN","AuthContext","stripePromise","PaymentButton","order","getToken","handlePayment","stripe","token","fetch","method","body","JSON","stringify","headers","response","json","session","redirectToCheckout","sessionId","id","result","propTypes","array"],"mappings":";;;;;;;;AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,UAAT,QAA2B,OAA3B;AACA,SAASC,UAAT,QAA2B,mBAA3B;AAEA,SAASC,oBAAT,EAA+BC,UAA/B,QAAiD,kBAAjD;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AAEA,IAAMC,aAAa,GAAGJ,UAAU,CAACC,oBAAD,CAAhC;;AAEA,IAAMI,aAAa,GAAG,SAAhBA,aAAgB,OAAe;AAAA;;AAAA,MAAZC,KAAY,QAAZA,KAAY;;AAAA,oBACdP,UAAU,CAACI,WAAD,CADI;AAAA,MAC3BI,QAD2B,eAC3BA,QAD2B;;AAGnC,MAAMC,aAAa;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACCJ,aADD;;AAAA;AACdK,cAAAA,MADc;AAAA;AAAA,qBAEAF,QAAQ,EAFR;;AAAA;AAEdG,cAAAA,KAFc;AAAA;AAAA,qBAGGC,KAAK,WAAIT,UAAJ,cAAyB;AACnDU,gBAAAA,MAAM,EAAE,MAD2C;AAEnDC,gBAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAET,kBAAAA,KAAK,EAALA;AAAF,iBAAf,CAF6C;AAGnDU,gBAAAA,OAAO,EAAE;AACP,kCAAgB,kBADT;AAEP,oDAA2BN,KAA3B;AAFO;AAH0C,eAAzB,CAHR;;AAAA;AAGdO,cAAAA,QAHc;AAAA;AAAA,qBAWEA,QAAQ,CAACC,IAAT,EAXF;;AAAA;AAWdC,cAAAA,OAXc;AAAA;AAAA,qBAYCV,MAAM,CAACW,kBAAP,CAA0B;AAC7CC,gBAAAA,SAAS,EAAEF,OAAO,CAACG;AAD0B,eAA1B,CAZD;;AAAA;AAYdC,cAAAA,MAZc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAbf,aAAa;AAAA;AAAA;AAAA,KAAnB;;AAiBA,sBACE;AACE,IAAA,OAAO,EAAEA,aADX;AAEE,IAAA,SAAS,EAAC,sJAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WADF;AAQD,CA5BD;;GAAMH,a;;KAAAA,a;AA8BNA,aAAa,CAACmB,SAAd,GAA0B;AACxBlB,EAAAA,KAAK,EAAER,SAAS,CAAC2B;AADO,CAA1B;AAIApB,aAAa,WAAb,GAAwB;AACtBC,EAAAA,KAAK,EAAE;AADe,CAAxB;AAIA,eAAeD,aAAf","sourcesContent":["import PropTypes from 'prop-types';\nimport { useContext } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\n\nimport { STRIPE_PUBLISHED_KEY, API_DOMAIN } from '@/config/globals';\nimport AuthContext from '@/context/AuthContext';\n\nconst stripePromise = loadStripe(STRIPE_PUBLISHED_KEY);\n\nconst PaymentButton = ({ order }) => {\n  const { getToken } = useContext(AuthContext);\n\n  const handlePayment = async () => {\n    const stripe = await stripePromise;\n    const token = await getToken();\n    const response = await fetch(`${API_DOMAIN}/orders`, {\n      method: 'POST',\n      body: JSON.stringify({ order }),\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      }\n    });\n    const session = await response.json();\n    const result = await stripe.redirectToCheckout({\n      sessionId: session.id\n    });\n  };\n\n  return (\n    <button\n      onClick={handlePayment}\n      className=\"flex flex-row flex-nowrap items-center justify-center font-bold px-4 py-3 rounded-lg bg-accent text-base shadow hover:bg-inactive hover:text-primary\"\n    >\n      Continuar al pago\n    </button>\n  );\n};\n\nPaymentButton.propTypes = {\n  order: PropTypes.array\n};\n\nPaymentButton.default = {\n  order: []\n};\n\nexport default PaymentButton;\n"]},"metadata":{},"sourceType":"module"}